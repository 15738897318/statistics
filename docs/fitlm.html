<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Statistics: fitlm</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
    </script>
    <style>
    var {
      font-style: italics;
      font-weight: bold;
    }
    td {
      vertical-align: top;
    }
    </style>
  </head>
  <body>
    <div class="bg-dark">
      <div class="container-xl">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
          <div class="container-fluid">
            <a class="navbar-brand" href=index.html>
              <img src="assets/statistics.png" alt="statistics" class="d-inline-block align-top" width="25" height="25">
              Statistics
            </a>
            <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="index.html#Model Fitting">
                    <i class="fas fa-list-alt"></i>
                    Model Fitting
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://gnu-octave.github.io/packages/">
                  <img src="assets/octave-logo.svg" alt="GNU Octave logo" class="d-inline-block align-top" width="25" height="25">
                    Octave Packages
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://www.octave.org">
                    <i class="fas fa-home"></i>
                    GNU Octave website
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>
    <div class="container-xl my-4">
      <div class="card rounded">
        <div class="card-header card-header-mod">
          <div class="row d-flex flex-wrap align-items-center">
            <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
              <h3 class="d-inline-block mr-2">
              Function&nbsp;Reference: <b><code>fitlm</code></b>
              </h3>
            </div>
          </div>
        </div>
        <div class="card-body">
<dl>
<dt><u>statistics:</u> <var>tab</var> = <b>fitlm</b><i> (<var>X</var>, <var>y</var>)</i></dt>
<dt><u>statistics:</u> <var>tab</var> = <b>fitlm</b><i> (<var>X</var>, <var>y</var>, <var>name</var>, <var>value</var>)</i></dt>
<dt><u>statistics:</u> <var>tab</var> = <b>fitlm</b><i> (<var>X</var>, <var>y</var>, <var>modelspec</var>)</i></dt>
<dt><u>statistics:</u> <var>tab</var> = <b>fitlm</b><i> (<var>X</var>, <var>y</var>, <var>modelspec</var>, <var>name</var>, <var>value</var>)</i></dt>
<dt><u>statistics:</u> [<var>tab</var>] = <b>fitlm</b><i> (&hellip;)</i></dt>
<dt><u>statistics:</u> [<var>tab</var>, <var>stats</var>] = <b>fitlm</b><i> (&hellip;)</i></dt>
<dt><u>statistics:</u> [<var>tab</var>, <var>stats</var>] = <b>fitlm</b><i> (&hellip;)</i></dt>
</dl>

<p> Regress the continuous outcome (i.e. dependent variable) <var>y</var> on
 continuous or categorical predictors (i.e. independent variables) <var>X</var>
 by minimizing the sum-of-squared residuals. Unless requested otherwise,
 <code>fitlm</code> prints the model formula, the regression coefficients (i.e.
 parameters/contrasts) and an ANOVA table. Note that unlike <code>anovan</code>,
 <code>fitlm</code> treats all factors as continuous by default.
</p>
<div class="ms-5">
<p> <var>X</var> must be a column major matrix or cell array consisting of the
 predictors. By default, there is a constant term in the model, unless you,
 explicitly remove it, so do not include a column of 1s in X. <var>y</var> must be
 a column vector corresponding to the outcome variable. <var>modelspec</var> can
 specified as one of the following:
</p>
 <ul>
<li>
 &quot;constant&quot; : model contains only a constant (intercept) term.

 </li><li>
 &quot;linear&quot; (default) : model contains an intercept and linear term for each
 predictor.

 </li><li>
 &quot;interactions&quot; : model contains an intercept, linear term for each predictor
 and all products of pairs of distinct predictors.

 </li><li>
 &quot;full&quot; : model contains an intercept, linear term for each predictor and
 all combinations of the predictors.

 </li><li>
 a matrix of term definitions : an t-by-(N+1) matrix specifying terms in
 a model, where t is the number of terms, N is the number of predictor
 variables, and +1 accounts for the outcome variable. The outcome variable
 is the last column in the terms matrix and must be a column of zeros.
 An intercept must be specified in the first row of the terms matrix and
 must be a row of zeros.
 </li></ul>

<p> <code>fitlm</code> can take a number of optional parameters as name-value pairs.
</p>
<p> <code>[&hellip;] = fitlm (..., &quot;CategoricalVars&quot;, <var>categorical</var>)</code>
</p>
 <ul>
<li>
 <var>categorical</var> is a vector of indices indicating which of the columns
 (i.e. variables) in <var>X</var> should be treated as categorical predictors
 rather than as continuous predictors.
 </li></ul>

<p> <code>fitlm</code> also accepts optional <code>anovan</code> parameters as name-value
 pairs (except for the &quot;model&quot; parameter). The accepted parameter names from
 <code>anovan</code> and their default values in <code>fitlm</code> are:
</p>
 <ul>
<li>
 <var>CONTRASTS</var> : &quot;treatment&quot;

 </li><li>
 <var>SSTYPE</var>: 2

 </li><li>
 <var>ALPHA</var>: 0.05

 </li><li>
 <var>DISPLAY</var>: &quot;on&quot;

 </li><li>
 <var>WEIGHTS</var>: [] (empty)

 </li><li>
 <var>RANDOM</var>: [] (empty)

 </li><li>
 <var>CONTINUOUS</var>: [1:N]

 </li><li>
 <var>VARNAMES</var>: [] (empty)
 </li></ul>

<p> Type &rsquo;<code>help anovan</code>&rsquo; to find out more about what these options do.
</p>
<p> <code>fitlm</code> can return up to two output arguments:
</p>
<p> [<var>tab</var>] = fitlm (&hellip;) returns a cell array containing a
 table of model parameters
</p>
<p> [<var>tab</var>, <var>stats</var>] = fitlm (&hellip;) returns a structure
 containing additional statistics, including degrees of freedom and effect
 sizes for each term in the linear model, the design matrix, the
 variance-covariance matrix, (weighted) model residuals, and the mean squared
 error. The columns of <var>stats</var>.coeffs (from left-to-right) report the
 model coefficients, standard errors, lower and upper 100*(1-alpha)%
 confidence interval bounds, t-statistics, and p-values relating to the
 contrasts. The number appended to each term name in <var>stats</var>.coeffnames
 corresponds to the column number in the relevant contrast matrix for that
 factor. The <var>stats</var> structure can be used as input for <code>multcompare</code>.
 The <var>stats</var> structure is recognised by the functions <code>bootcoeff</code>
 and <code>bootemm</code> from the statistics-bootstrap package. Note that if the
 model contains a continuous variable and you wish to use the <var>STATS</var>
 output as input to <code>multcompare</code>, then the model needs to be refit
 with the &quot;contrast&quot; parameter set to a sum-to-zero contrast coding scheme,
 e.g.&quot;simple&quot;.
</p>
<p> <strong>See also: </strong>
  <a href="anovan.html">anovan</a>, 
  <a href="multcompare.html">multcompare</a>
</p>
<p><strong>Source Code: </strong>
  <a href="https://github.com/gnu-octave/statistics/tree/main/inst/fitlm.m">fitlm</a>
</div>
        <div class="container-xl my-4">
          <div class="card rounded">
            <div class="card-header card-header-mod">
              <div class="row d-flex flex-wrap align-items-center">
                <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
                  <h3 class="d-inline-block mr-2">
                  Example: 1
                  </h3>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="container bg-light">
                <div class="row">
                  <table><tbody><tr>
                    <td>&nbsp;</td>
                    <td><pre class="example">

 y =  [ 8.706 10.362 11.552  6.941 10.983 10.092  6.421 14.943 15.931 ...
        22.968 18.590 16.567 15.944 21.637 14.492 17.965 18.851 22.891 ...
        22.028 16.884 17.252 18.325 25.435 19.141 21.238 22.196 18.038 ...
        22.628 31.163 26.053 24.419 32.145 28.966 30.207 29.142 33.212 ...
        25.694 ]';
 X = [1 1 1 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 3 3 3 4 4 4 4 4 4 4 5 5 5 5 5 5 5 5 5]';

 [TAB,STATS] = fitlm (X,y,"linear","CategoricalVars",1,"display","on");


MODEL FORMULA (based on Wilkinson's notation):

Y ~ 1 + X1

MODEL PARAMETERS (contrasts for the fixed effects)

Parameter               Estimate        SE  Lower.CI  Upper.CI        t Prob>|t|
--------------------------------------------------------------------------------
(Intercept)                   10      1.02      7.93      12.1     9.83    <.001 
X1_1                           8      1.64      4.66      11.3     4.87    <.001 
X1_2                           9      1.44      6.07      11.9     6.25    <.001 
X1_3                          11      1.49      7.97        14     7.38    <.001 
X1_4                          19       1.4      16.2      21.8    13.58    <.001 

ANOVA TABLE (Type II sums-of-squares):

Source                   Sum Sq.    d.f.    Mean Sq.  R Sq.            F  Prob>F
--------------------------------------------------------------------------------
X1                        1561.3       4      390.33  0.855        47.10   <.001 
Error                     265.17      32      8.2866
Total                     1826.5      36 

                    </pre></td></tr></tbody>
                  </table>
                  <div class="text-center">
                    <img src="assets/fitlm_101.png" class="rounded img-thumbnail" alt="plotted figure">
                  </div><p></p>

                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="container-xl my-4">
          <div class="card rounded">
            <div class="card-header card-header-mod">
              <div class="row d-flex flex-wrap align-items-center">
                <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
                  <h3 class="d-inline-block mr-2">
                  Example: 2
                  </h3>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="container bg-light">
                <div class="row">
                  <table><tbody><tr>
                    <td>&nbsp;</td>
                    <td><pre class="example">

 popcorn = [5.5, 4.5, 3.5; 5.5, 4.5, 4.0; 6.0, 4.0, 3.0; ...
            6.5, 5.0, 4.0; 7.0, 5.5, 5.0; 7.0, 5.0, 4.5];
 brands = {'Gourmet', 'National', 'Generic'; ...
           'Gourmet', 'National', 'Generic'; ...
           'Gourmet', 'National', 'Generic'; ...
           'Gourmet', 'National', 'Generic'; ...
           'Gourmet', 'National', 'Generic'; ...
           'Gourmet', 'National', 'Generic'};
 popper = {'oil', 'oil', 'oil'; 'oil', 'oil', 'oil'; 'oil', 'oil', 'oil'; ...
           'air', 'air', 'air'; 'air', 'air', 'air'; 'air', 'air', 'air'};

 [TAB, STATS] = fitlm ({brands(:),popper(:)},popcorn(:),"interactions",...
                          "CategoricalVars",[1,2],"display","on");


MODEL FORMULA (based on Wilkinson's notation):

Y ~ 1 + X1 + X2 + X1:X2

MODEL PARAMETERS (contrasts for the fixed effects)

Parameter               Estimate        SE  Lower.CI  Upper.CI        t Prob>|t|
--------------------------------------------------------------------------------
(Intercept)                 5.67     0.215       5.2      6.14    26.34    <.001 
X1_1                       -1.33     0.304        -2     -0.67    -4.38    <.001 
X1_2                       -2.17     0.304     -2.83      -1.5    -7.12    <.001 
X2_1                        1.17     0.304     0.504      1.83     3.83     .002 
X1:X2_1                   -0.333      0.43     -1.27     0.604    -0.77     .454 
X1:X2_2                   -0.167      0.43      -1.1     0.771    -0.39     .705 

ANOVA TABLE (Type II sums-of-squares):

Source                   Sum Sq.    d.f.    Mean Sq.  R Sq.            F  Prob>F
--------------------------------------------------------------------------------
X1                         15.75       2       7.875  0.904        56.70   <.001 
X2                           4.5       1         4.5  0.730        32.40   <.001 
X1*X2                   0.083333       2    0.041667  0.048         0.30    .746 
Error                     1.6667      12     0.13889
Total                         22      17 

                    </pre></td></tr></tbody>
                  </table>
                  <div class="text-center">
                    <img src="assets/fitlm_201.png" class="rounded img-thumbnail" alt="plotted figure">
                  </div><p></p>

                </div>
              </div>
            </div>
          </div>
        </div>


        </div>
      </div>
    </div>

  </body>
</html>
