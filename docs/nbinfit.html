<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Statistics: nbinfit</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
    </script>
    <style>
    var {
      font-style: italics;
      font-weight: bold;
    }
    td {
      vertical-align: top;
    }
    </style>
  </head>
  <body>
    <div class="bg-dark">
      <div class="container-xl">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
          <div class="container-fluid">
            <a class="navbar-brand" href=index.html>
              <img src="assets/statistics.png" alt="statistics" class="d-inline-block align-top" width="25" height="25">
              Statistics
            </a>
            <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="index.html#Distribution Fitting">
                    <i class="fas fa-list-alt"></i>
                    Distribution Fitting
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://gnu-octave.github.io/packages/">
                  <img src="assets/octave-logo.svg" alt="GNU Octave logo" class="d-inline-block align-top" width="25" height="25">
                    Octave Packages
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://www.octave.org">
                    <i class="fas fa-home"></i>
                    GNU Octave website
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>
    <div class="container-xl my-4">
      <div class="card rounded">
        <div class="card-header card-header-mod">
          <div class="row d-flex flex-wrap align-items-center">
            <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
              <h3 class="d-inline-block mr-2">
              Function&nbsp;Reference: <b><code>nbinfit</code></b>
              </h3>
            </div>
          </div>
        </div>
        <div class="card-body">
<dl>
<dt><u>statistics:</u> <var>paramhat</var> = <b>nbinfit</b><i> (<var>x</var>)</i></dt>
<dt><u>statistics:</u> [<var>paramhat</var>, <var>paramci</var>] = <b>nbinfit</b><i> (<var>x</var>)</i></dt>
<dt><u>statistics:</u> [<var>paramhat</var>, <var>paramci</var>] = <b>nbinfit</b><i> (<var>x</var>, <var>alpha</var>)</i></dt>
<dt><u>statistics:</u> [<var>paramhat</var>, <var>paramci</var>] = <b>nbinfit</b><i> (<var>x</var>, <var>alpha</var>, <var>options</var>)</i></dt>
</dl>

<p> Estimate parameter and confidence intervals for the negative binomial
 distribution.
</p>
<div class="ms-5">
<p> <code><var>paramhat</var> = nbinfit (<var>x</var>)</code> returns the maximum likelihood
 estimates of the parameters of the negative binomial distribution given the
 data in vector <var>x</var>.  <code><var>paramhat</var>(1)</code> is the number of successes
 until the experiment is stopped, <var>r</var>, and <code><var>paramhat</var>(1)</code> is
 the probability of success in each experiment, <var>ps</var>.
</p>
<p> <code>[<var>paramhat</var>, <var>paramci</var>] = nbinfit (<var>x</var>)</code> returns the 95%
 confidence intervals for the parameter estimates.
</p>
<p> <code>[<var>paramhat</var>, <var>paramci</var>] = nbinfit (<var>x</var>, <var>alpha</var>)</code> also
 returns the <code>100 * (1 - <var>alpha</var>)</code> percent confidence intervals of
 the estimated parameter.  By default, the optional argument <var>alpha</var> is
 0.05 corresponding to 95% confidence intervals.
</p>
<p> <code>[<var>paramhat</var>, <var>paramci</var>] = nbinfit (<var>x</var>, <var>alpha</var>,
 <var>options</var>)</code> specifies control parameters for the iterative algorithm used
 to compute ML estimates with the <code>fminsearch</code> function.  <var>options</var>
 is a structure with the following fields and their default values:
 </p><ul>
<li> <code><var>options</var>.Display = &quot;off&quot;</code>
 </li><li> <code><var>options</var>.MaxFunEvals = 400</code>
 </li><li> <code><var>options</var>.MaxIter = 200</code>
 </li><li> <code><var>options</var>.TolX = 1e-6</code>
 </li></ul>

<p> When <var>r</var> is an integer, the negative binomial distribution is also known
 as the Pascal distribution and it models the number of failures in <var>x</var>
 before a specified number of successes is reached in a series of independent,
 identical trials.  Its parameters are the probability of success in a single
 trial, <var>ps</var>, and the number of successes, <var>r</var>.  A special case of the
 negative binomial distribution, when <code><var>r</var> = 1</code>, is the geometric
 distribution, which models the number of failures before the first success.
</p>
<p> <var>r</var> can also have non-integer positive values, in which form the negative
 binomial distribution, also known as the Polya distribution, has no
 interpretation in terms of repeated trials, but, like the Poisson
 distribution, it is useful in modeling count data.  The negative binomial
 distribution is more general than the Poisson distribution because it has a
 variance that is greater than its mean, making it suitable for count data
 that do not meet the assumptions of the Poisson distribution.  In the limit,
 as <var>r</var> increases to infinity, the negative binomial distribution
 approaches the Poisson distribution.
</p>
<p> Further information about the negative binomial distribution can be found at
 <a href="https://en.wikipedia.org/wiki/Negative_binomial_distribution">https://en.wikipedia.org/wiki/Negative_binomial_distribution</a>
</p>
<p> <strong>See also: </strong>
  <a href="nbincdf.html">nbincdf</a>, 
  <a href="nbininv.html">nbininv</a>, 
  <a href="nbinpdf.html">nbinpdf</a>, 
  <a href="nbinrnd.html">nbinrnd</a>, 
  <a href="nbinlike.html">nbinlike</a>, 
  <a href="nbinstat.html">nbinstat</a>
</p>
</div>
        <div class="container-xl my-4">
          <div class="card rounded">
            <div class="card-header card-header-mod">
              <div class="row d-flex flex-wrap align-items-center">
                <div class="col-sm-3 col-md-5 mb-2 mb-sm-0">
                  <h3 class="d-inline-block mr-2">
                  Example: 1
                  </h3>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="container bg-light">
                <div class="row">
                  <table><tbody><tr>
                    <td>&nbsp;</td>
                    <td><pre class="example">

 ## Sample 2 populations from different negative binomial distibutions
 randp ("seed", 5); randg ("seed", 5);    # for reproducibility
 r1 = nbinrnd (2, 0.15, 5000, 1);
 randp ("seed", 8); randg ("seed", 8);    # for reproducibility
 r2 = nbinrnd (5, 0.2, 5000, 1);
 r = [r1, r2];

 ## Plot them normalized and fix their colors
 hist (r, [0:51], 1);
 h = findobj (gca, "Type", "patch");
 set (h(1), "facecolor", "c");
 set (h(2), "facecolor", "g");
 hold on

 ## Estimate their probability of success
 r_psA = nbinfit (r(:,1));
 r_psB = nbinfit (r(:,2));

 ## Plot their estimated PDFs
 x = [0:40];
 y = nbinpdf (x, r_psA(1), r_psA(2));
 plot (x, y, "-pg");
 x = [min(r(:,2)):max(r(:,2))];
 y = nbinpdf (x, r_psB(1), r_psB(2));
 plot (x, y, "-sc");
 ylim ([0, 0.1])
 xlim ([0, 50])
 legend ({"Normalized HIST of sample 1 with r=2 and ps=0.15", ...
          "Normalized HIST of sample 2 with r=5 and ps=0.2", ...
          sprintf("PDF for sample 1 with estimated r=%0.2f and ps=%0.2f", ...
                  r_psA(1), r_psA(2)), ...
          sprintf("PDF for sample 2 with estimated r=%0.2f and ps=%0.2f", ...
                  r_psB(1), r_psB(2))})
 title ("Two population samples from negative different binomial distibutions")
 hold off

                    </pre></td></tr></tbody>
                  </table>
                  <div class="text-center">
                    <img src="assets/nbinfit_101.png" class="rounded img-thumbnail" alt="plotted figure">
                  </div><p></p>

                </div>
              </div>
            </div>
          </div>
        </div>


        </div>
      </div>
    </div>

  </body>
</html>
